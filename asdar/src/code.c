#include "code.h"
#include <stdio.h>
#include "object.h"

void codeop_debug(enum CodeOpKind k)
{
	switch(k) {
	#define BOILERPLATE(KIND) case KIND: puts(#KIND); break;
		BOILERPLATE(CODE_CONSTANT)
		BOILERPLATE(CODE_CALLCODEFUNC)
		BOILERPLATE(CODE_CALLBUILTINFUNC)
		BOILERPLATE(CODE_JUMP)
		BOILERPLATE(CODE_JUMPIF)
		BOILERPLATE(CODE_STRJOIN)
		BOILERPLATE(CODE_THROW)
		BOILERPLATE(CODE_RETURN)
		BOILERPLATE(CODE_DUP)
		BOILERPLATE(CODE_SWAP)
		BOILERPLATE(CODE_POP)
	#undef BOILERPLATE
	}
}

void codeop_destroy(struct CodeOp op)
{
	if (op.kind == CODE_CONSTANT)
		OBJECT_DECREF(op.data.obj);
}
